# PDF Stream Expositor


## Description
**PDF Stream Expositor** is a specialized utility designed for deep-level analysis and restoration of PDF content streams. It is specifically developed to uncover hidden or obscured elements (such as mathematical formulas or redacted text) by analyzing, visualizing, and modifying the underlying PDF operators.

This project provides a surgical approach to PDF forensics: dumping raw streams, generating incremental render snapshots, and selectively deactivating masking operators like `Do`.


## Project Structure
The project is organized into the following directories:

- `/src`: Contains the core Python modules.
  - `extractor.py`: Extracts raw content streams into human-readable text.
  - `stepper.py`: Generates incremental PDFs to identify exactly where elements disappear.
  - `remover.py`: Comments out specific operators (e.g., `Do`) to reveal background content.
- `/sample`: Contains sample files.
  - `create_sample.py`: Generates a sample PDF (`target.pdf`).
  - `mask.png`: Mask image used for the sample PDF.
- `main.py`: The entry point to execute the analysis modules.
- `requirements.txt`: Lists the necessary Python dependencies.


## Requirements
Before running the scripts, you need to install the following dependencies:
- **PyMuPDF (fitz)**: The primary library for PDF manipulation and stream access.

To install the requirements, run the following command:
```bash
pip install -r requirements.txt
```

## Recommended Workflow
To effectively demask hidden content, follow these steps:

1. **Extraction**: Use `extractor.py` to dump the page stream and find the approximate line numbers of `Do` or other suspicious operators.

2. **Stepping**: Use `stepper.py` to generate snapshots. By observing these files, you can pinpoint the exact line where the masking element is rendered.

3. **Removal**: Use `remover.py` to comment out the identified line(s) or range. This will generate a "cleaned" PDF with the hidden content exposed.

## Quick Start (Try with Sample)
To see the tool in action, you can generate a sample masked PDF:

1. **Generate Sample**:
   ```bash
   python sample/create_sample.py
   ```
2. **Analyze**:
Run `main.py` (pre-configured for `sample/target.pdf`) to see how the hidden message is revealed in the generated output files.

## Release / Output Directory

When you run the tools, the following directories/files will be generated by default:
- `{filename}_streams/`: Created by the Extractor, containing `.txt` dumps of the streams.
- `{filename}_steps/`: Created by the Stepper, containing multiple `.pdf` snapshots.
- `{filename}_rem.pdf`: Created by the Remover, representing the final demasked result.

## Disclaimer
This toolset is provided for **educational and forensic analysis purposes only**. 

- **Compliance**: The user is solely responsible for ensuring that their use of this software complies with all applicable laws, regulations, and the terms of service of any analyzed PDF documents.
- **No Warranty**: This software is provided "as is" without warranty of any kind. The author shall not be liable for any damages, data loss, or legal issues arising from the use or misuse of this toolset.
- **Prohibited Use**: Do not use this tool for unauthorized access to protected information or any activities that violate intellectual property rights.

## License
This project is licensed under the MIT License - see the LICENSE file for details.